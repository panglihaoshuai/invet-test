# 📧 邮箱登录 - 快速测试指南

## ⚡ 3分钟快速测试

### 步骤1: 启动应用（30秒）

```bash
cd /workspace/app-7gjbw3zqrmdd
npm run dev
```

等待看到：
```
➜  Local:   http://localhost:5173/
```

---

### 步骤2: 访问登录页面（10秒）

打开浏览器访问：
```
http://localhost:5173/login
```

---

### 步骤3: 发送验证码（30秒）

1. **输入邮箱地址**
   ```
   推荐使用管理员邮箱：1062250152@qq.com
   或使用您自己的邮箱
   ```

2. **点击"发送验证码"按钮**

3. **等待提示**
   ```
   ✅ 成功：显示"验证码已发送到 xxx@xxx.com，请查收邮件"
   ❌ 失败：显示错误信息
   ```

---

### 步骤4: 检查邮箱（1分钟）

1. **打开邮箱收件箱**
   - 查找来自 `noreply@mail.app.supabase.io` 的邮件
   - 邮件主题：`Confirm your signup`

2. **如果没有收到邮件**
   - 检查垃圾邮件箱
   - 等待1-2分钟（邮件可能延迟）
   - 确认邮箱地址输入正确

3. **找到验证码**
   - 邮件中会显示：`Or enter this code: 123456`
   - 复制这6位数字验证码

---

### 步骤5: 验证登录（30秒）

1. **输入验证码**
   - 在登录页面输入6位数字验证码

2. **点击"验证登录"按钮**

3. **登录成功！**
   ```
   ✅ 管理员邮箱（1062250152@qq.com）
      → 自动跳转到管理后台 /admin
      → 显示"欢迎管理员！"
   
   ✅ 普通邮箱
      → 跳转到首页 /
      → 显示"欢迎使用人格特质投资策略评估系统"
   ```

---

## ⚠️ 重要提示

### Supabase 默认邮件限制

```
每小时限制：3 封邮件
每天限制：30 封邮件
```

**如果达到限制**：
- 等待1小时后重试
- 或配置自定义 SMTP 服务（见下文）

---

## 🐛 常见问题

### 问题1: 收不到验证码邮件

**检查清单**：
- [ ] 邮箱地址是否正确？
- [ ] 是否检查了垃圾邮件箱？
- [ ] 是否等待了1-2分钟？
- [ ] 是否达到发送限制（每小时3封）？

**解决方案**：
```bash
# 1. 检查 Supabase 日志
# 访问：https://supabase.com/dashboard/project/ahgnspudsmrvsqcinxcj/logs/auth-logs

# 2. 等待1小时后重试（如果达到限制）

# 3. 配置自定义 SMTP 服务（推荐）
# 参考：邮箱登录配置指南.md
```

### 问题2: 验证码错误或已过期

**原因**：
- 验证码输入错误
- 验证码已过期（5分钟有效期）
- 使用了旧的验证码

**解决方案**：
```
1. 仔细检查验证码（6位数字）
2. 如果超过5分钟，点击"重新发送"
3. 确保使用最新的验证码
```

### 问题3: 点击"发送验证码"无反应

**检查清单**：
- [ ] 是否输入了邮箱地址？
- [ ] 邮箱格式是否正确？
- [ ] 是否在倒计时期间（60秒）？
- [ ] 浏览器控制台是否有错误？

**解决方案**：
```bash
# 1. 打开浏览器开发者工具（F12）
# 2. 查看 Console 标签页
# 3. 查看是否有错误信息
# 4. 查看 Network 标签页
# 5. 检查 API 请求是否成功
```

---

## 🔧 配置自定义 SMTP（可选）

### 为什么需要？

使用自定义 SMTP 的好处：
- ✅ 无发送限制
- ✅ 更高的送达率
- ✅ 自定义邮件模板
- ✅ 自定义发件人信息

### 快速配置（5分钟）

#### 选项1: 使用 QQ 邮箱（推荐国内用户）

```
1. 登录 QQ 邮箱
2. 设置 → 账户 → 开启 SMTP 服务
3. 生成授权码
4. 在 Supabase Dashboard 配置：
   
   SMTP Host: smtp.qq.com
   SMTP Port: 587
   SMTP User: 1062250152@qq.com
   SMTP Password: [授权码]
   Sender Email: 1062250152@qq.com
   Sender Name: 人格特质投资策略评估系统
```

#### 选项2: 使用 Gmail（推荐国际用户）

```
1. 启用 Gmail 两步验证
2. 生成应用专用密码
3. 在 Supabase Dashboard 配置：
   
   SMTP Host: smtp.gmail.com
   SMTP Port: 587
   SMTP User: your-email@gmail.com
   SMTP Password: [应用专用密码]
   Sender Email: your-email@gmail.com
   Sender Name: 人格特质投资策略评估系统
```

### 详细配置步骤

参考完整指南：
```bash
cat 邮箱登录配置指南.md
```

---

## 📊 测试结果验证

### 成功标志

#### 1. 发送验证码成功
```
✅ 显示提示："验证码已发送到 xxx@xxx.com，请查收邮件"
✅ 倒计时开始（60秒）
✅ "发送验证码"按钮变为"重新发送"
✅ 显示验证码输入框
```

#### 2. 收到邮件
```
✅ 收件箱或垃圾邮件箱中有新邮件
✅ 发件人：noreply@mail.app.supabase.io
✅ 主题：Confirm your signup
✅ 邮件中包含6位数字验证码
```

#### 3. 验证登录成功
```
✅ 显示提示："登录成功"
✅ 管理员：显示"欢迎管理员！"
✅ 普通用户：显示"欢迎使用人格特质投资策略评估系统"
✅ 自动跳转到相应页面
```

---

## 🎯 下一步

### 测试完成后

1. **测试其他功能**
   ```
   - 人格测试
   - 数学金融能力测试
   - 风险偏好测试
   - 报告生成
   - 管理后台（如果是管理员）
   ```

2. **配置生产环境**
   ```
   - 配置自定义 SMTP
   - 自定义邮件模板
   - 配置域名
   - 部署到服务器
   ```

3. **查看相关文档**
   ```bash
   # 管理员配置
   cat 管理员自动分配说明.md
   
   # 完整邮箱配置
   cat 邮箱登录配置指南.md
   
   # 系统快速开始
   cat 快速开始.md
   ```

---

## 📞 需要帮助？

### 查看日志

```bash
# 1. 浏览器控制台日志
# 按 F12 → Console 标签页

# 2. Supabase 认证日志
# 访问：https://supabase.com/dashboard/project/ahgnspudsmrvsqcinxcj/logs/auth-logs

# 3. 应用日志
# 查看终端输出
```

### 常见错误代码

| 错误 | 原因 | 解决方案 |
|------|------|----------|
| `Email rate limit exceeded` | 超过发送限制 | 等待1小时或配置自定义SMTP |
| `Invalid email` | 邮箱格式错误 | 检查邮箱格式 |
| `Token expired` | 验证码过期 | 重新获取验证码 |
| `Invalid token` | 验证码错误 | 检查验证码是否正确 |

---

## ✅ 测试检查清单

- [ ] 应用已启动（npm run dev）
- [ ] 可以访问登录页面
- [ ] 可以输入邮箱地址
- [ ] 可以发送验证码
- [ ] 收到验证码邮件
- [ ] 可以输入验证码
- [ ] 验证登录成功
- [ ] 正确跳转到相应页面
- [ ] 管理员邮箱自动获得管理员权限

---

**测试时间**: 约3分钟  
**难度**: ⭐⭐☆☆☆（简单）  
**状态**: ✅ 可以立即测试

**开始测试**：
```bash
cd /workspace/app-7gjbw3zqrmdd && npm run dev
```
