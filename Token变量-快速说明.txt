
                  📧 {{ .Token }} 变量说明                           ║


                    ✅ 重要：不需要配置！                              │


  {{ .Token }} 是 Supabase 的内置变量
  
  ✅ 不需要配置
  ✅ 不需要设置
  ✅ 不需要编写代码
  ✅ 自动生成验证码
  ✅ 自动替换为实际数字


                    🔍 什么是 {{ .Token }}？                          │


  {{ .Token }} 是一个占位符变量
  
  在邮件模板中：
    您写：{{ .Token }}
    
  用户收到的邮件中：
    显示：123456  ← 自动生成的6位数字验证码


                    🔄 工作流程                                        │


  1. 用户点击"发送验证码"
     ↓
  2. 应用调用 Supabase API
     ↓
  3. Supabase 自动生成 6位数字（例如：123456）
     ↓
  4. Supabase 读取邮件模板
     ↓
  5. 将 {{ .Token }} 替换为 123456
     ↓
  6. 发送邮件给用户
     ↓
  7. 用户收到包含验证码的邮件


                    📝 如何使用                                        │


  在邮件模板中，直接写入 {{ .Token }}：
  
  ┌────────────────────────────────────────────────────────────────┐
  │ 邮件模板内容：                                                 │
  │                                                                │
  │ <h2>您的验证码</h2>                                            │
  │ <p>验证码是：</p>                                              │
  │ <h1>{{ .Token }}</h1>                                          │
  │ <p>5分钟内有效</p>                                             │
  └────────────────────────────────────────────────────────────────┘
  
  用户收到的邮件：
  
  ┌────────────────────────────────────────────────────────────────┐
  │ 您的验证码                                                     │
  │                                                                │
  │ 验证码是：                                                     │
  │                                                                │
  │ 123456  ← {{ .Token }} 被自动替换为实际验证码                 │
  │                                                                │
  │ 5分钟内有效                                                    │
  └────────────────────────────────────────────────────────────────┘


                    🆚 变量对比                                        │


  {{ .Token }}
  ─────────────────────────────────────────────────────────────────
  类型：     6位数字验证码
  示例：     123456
  用途：     OTP 登录（用户手动输入）
  模板：     Confirm signup
  
  ✅ 这是我们需要的！
  
  
  {{ .ConfirmationURL }}
  ─────────────────────────────────────────────────────────────────
  类型：     完整的 URL 链接
  示例：     https://xxx.supabase.co/auth/v1/verify?token=...
  用途：     魔法链接登录（用户点击链接）
  模板：     Magic Link
  
  ❌ 这不是我们需要的！


                    ⚙️  验证码特性                                     │


  自动生成的验证码：
  
  格式：      6位数字
  示例：      123456, 789012, 456789
  有效期：    5分钟（300秒）
  唯一性：    每次请求生成新的
  安全性：    随机生成，不可预测
  使用次数：  只能使用一次


                    ✅ 配置检查清单                                    │


  代码配置（已完成，不需要修改）：
  
  [x] LoginPage.tsx 使用 signInWithOtp 方法
  [x] LoginPage.tsx 使用 verifyOtp 方法
  [x] 验证码输入框（6位数字）
  [x] 倒计时功能（60秒）
  [x] 错误处理和提示
  
  
  Supabase 配置（需要您操作）：
  
  [ ] 访问 Supabase Dashboard
  [ ] 进入 Email Templates
  [ ] 找到 "Confirm signup" 模板
  [ ] 在模板中添加 {{ .Token }}
  [ ] 保存模板
  [ ] 测试发送验证码
  
  
  环境变量（已配置，不需要修改）：
  
  [x] VITE_SUPABASE_URL
  [x] VITE_SUPABASE_ANON_KEY
  [x] VITE_ADMIN_EMAIL


                    🎯 关键要点                                        │


  1. {{ .Token }} 是自动的
     ✅ 不需要配置任何东西
     ✅ Supabase 会自动生成验证码
     ✅ Supabase 会自动替换变量
     
  2. 只需要在邮件模板中使用
     ✅ 在 "Confirm signup" 模板中写入 {{ .Token }}
     ✅ 保存模板
     ✅ 就这么简单！
     
  3. 代码已经正确实现
     ✅ LoginPage.tsx 已经使用了正确的方法
     ✅ 不需要修改任何代码
     ✅ 只需要配置邮件模板


                    ❌ 常见错误                                        │


  错误1: 使用了错误的变量
  ─────────────────────────────────────────────────────────────────
  ❌ 错误：{{ .ConfirmationURL }}  ← 这会生成链接
  ✅ 正确：{{ .Token }}            ← 这会生成验证码
  
  
  错误2: 修改了错误的模板
  ─────────────────────────────────────────────────────────────────
  ❌ 错误：修改 "Magic Link" 模板
  ✅ 正确：修改 "Confirm signup" 模板
  
  
  错误3: 变量语法错误
  ─────────────────────────────────────────────────────────────────
  ❌ 错误：{ .Token }              ← 少了一个大括号
  ❌ 错误：{{{ .Token }}}          ← 多了一个大括号
  ❌ 错误：{{ Token }}             ← 少了点号
  ✅ 正确：{{ .Token }}            ← 正确的语法


                    📚 详细文档                                        │


  完整说明:
    cat Token变量说明.md
    
  邮件模板配置:
    cat 必读-邮件模板配置.txt
    
  故障排查:
    cat 故障排查-验证码邮件.md


                    💡 总结                                            │


  {{ .Token }} 不需要配置！
  
  这是 Supabase 的内置变量，会自动工作。
  
  您只需要：
  1. 在 "Confirm signup" 邮件模板中写入 {{ .Token }}
  2. 保存模板
  3. 测试
  
  就这么简单！


              {{ .Token }} 是自动的，您只需要使用它！                ║
