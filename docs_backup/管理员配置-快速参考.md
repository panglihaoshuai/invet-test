# ğŸ”‘ ç®¡ç†å‘˜é…ç½® - å¿«é€Ÿå‚è€ƒ

## ğŸ“‹ å½“å‰é…ç½®

### ç®¡ç†å‘˜é‚®ç®±
```
1062250152@qq.com
```

### è‡ªåŠ¨åˆ†é…è§„åˆ™
- âœ… `1062250152@qq.com` æ³¨å†Œ â†’ è‡ªåŠ¨æˆä¸ºç®¡ç†å‘˜
- âŒ å…¶ä»–é‚®ç®±æ³¨å†Œ â†’ é»˜è®¤ä¸ºæ™®é€šç”¨æˆ·
- âœ… ç®¡ç†å‘˜å¯æ‰‹åŠ¨æå‡å…¶ä»–ç”¨æˆ·

---

## ğŸš€ å¿«é€Ÿæ“ä½œ

### æŸ¥çœ‹ç®¡ç†å‘˜é‚®ç®±é…ç½®
```sql
SELECT config_value FROM system_config WHERE config_key = 'admin_email';
```

### æŸ¥çœ‹æ‰€æœ‰ç®¡ç†å‘˜
```sql
SELECT email, role, created_at FROM profiles WHERE role = 'admin';
```

### æ·»åŠ ç®¡ç†å‘˜
```sql
UPDATE profiles SET role = 'admin'::user_role WHERE email = 'user@example.com';
```

### ç§»é™¤ç®¡ç†å‘˜
```sql
UPDATE profiles SET role = 'user'::user_role WHERE email = 'user@example.com';
```

### æ›´æ”¹ç®¡ç†å‘˜é‚®ç®±
```sql
UPDATE system_config SET config_value = 'new-admin@example.com' WHERE config_key = 'admin_email';
```

---

## âœ… éªŒè¯é…ç½®

### 1. æ£€æŸ¥é…ç½®ï¼ˆ10ç§’ï¼‰
```sql
SELECT config_value FROM system_config WHERE config_key = 'admin_email';
```
**é¢„æœŸç»“æœ**: `1062250152@qq.com`

### 2. æ£€æŸ¥è§¦å‘å™¨ï¼ˆ10ç§’ï¼‰
```sql
SELECT trigger_name FROM information_schema.triggers 
WHERE trigger_name = 'trigger_auto_assign_admin_role';
```
**é¢„æœŸç»“æœ**: è¿”å›ä¸€æ¡è®°å½•

### 3. æµ‹è¯•æ³¨å†Œï¼ˆ2åˆ†é’Ÿï¼‰
```
1. ä½¿ç”¨ 1062250152@qq.com ç™»å½•
2. å®ŒæˆéªŒè¯ç éªŒè¯
3. åˆ·æ–°é¡µé¢
4. ç¡®è®¤çœ‹åˆ°"ç®¡ç†å‘˜åå°"æŒ‰é’®
```

---

## ğŸ¯ å¸¸è§åœºæ™¯

### åœºæ™¯1: æ·»åŠ æ–°ç®¡ç†å‘˜
```sql
-- æ­¥éª¤1: è®©ç”¨æˆ·å…ˆæ³¨å†Œè´¦å·
-- æ­¥éª¤2: æå‡ä¸ºç®¡ç†å‘˜
UPDATE profiles SET role = 'admin'::user_role WHERE email = 'new-admin@example.com';
```

### åœºæ™¯2: ç§»é™¤ç®¡ç†å‘˜æƒé™
```sql
UPDATE profiles SET role = 'user'::user_role WHERE email = 'old-admin@example.com';
```

### åœºæ™¯3: æ›´æ¢ä¸»ç®¡ç†å‘˜
```sql
-- æ­¥éª¤1: æ›´æ–°é…ç½®
UPDATE system_config SET config_value = 'new-admin@example.com' WHERE config_key = 'admin_email';

-- æ­¥éª¤2: æå‡æ–°ç®¡ç†å‘˜ï¼ˆå¦‚æœå·²æ³¨å†Œï¼‰
UPDATE profiles SET role = 'admin'::user_role WHERE email = 'new-admin@example.com';

-- æ­¥éª¤3: å¯é€‰ - ç§»é™¤æ—§ç®¡ç†å‘˜
UPDATE profiles SET role = 'user'::user_role WHERE email = '1062250152@qq.com';
```

---

## ğŸ› å¿«é€Ÿæ•…éšœæ’æŸ¥

### é—®é¢˜: ç®¡ç†å‘˜é‚®ç®±æ³¨å†Œåæ²¡æœ‰æƒé™

**è§£å†³æ–¹æ¡ˆ**:
```sql
-- æ‰‹åŠ¨åˆ†é…ç®¡ç†å‘˜æƒé™
UPDATE profiles SET role = 'admin'::user_role WHERE email = '1062250152@qq.com';
```

### é—®é¢˜: è§¦å‘å™¨ä¸å·¥ä½œ

**è§£å†³æ–¹æ¡ˆ**:
```sql
-- é‡æ–°åˆ›å»ºè§¦å‘å™¨
DROP TRIGGER IF EXISTS trigger_auto_assign_admin_role ON profiles;

CREATE TRIGGER trigger_auto_assign_admin_role
  BEFORE INSERT ON profiles
  FOR EACH ROW
  EXECUTE FUNCTION auto_assign_admin_role();
```

### é—®é¢˜: æ— æ³•çœ‹åˆ°ç®¡ç†å‘˜åå°

**è§£å†³æ–¹æ¡ˆ**:
```sql
-- 1. æ£€æŸ¥è§’è‰²
SELECT email, role FROM profiles WHERE email = '1062250152@qq.com';

-- 2. å¦‚æœä¸æ˜¯ adminï¼Œæ‰‹åŠ¨æ›´æ–°
UPDATE profiles SET role = 'admin'::user_role WHERE email = '1062250152@qq.com';

-- 3. åˆ·æ–°æµè§ˆå™¨ï¼ˆF5ï¼‰
```

---

## ğŸ“Š ç³»ç»Ÿæ£€æŸ¥è„šæœ¬

### å®Œæ•´æ£€æŸ¥
```sql
-- ç®¡ç†å‘˜é‚®ç®±é…ç½®
SELECT 'ç®¡ç†å‘˜é‚®ç®±é…ç½®' as "æ£€æŸ¥é¡¹", config_value as "å€¼" 
FROM system_config WHERE config_key = 'admin_email';

-- å½“å‰ç®¡ç†å‘˜åˆ—è¡¨
SELECT 'å½“å‰ç®¡ç†å‘˜' as "æ£€æŸ¥é¡¹", email as "é‚®ç®±", created_at as "æ³¨å†Œæ—¶é—´" 
FROM profiles WHERE role = 'admin';

-- è§¦å‘å™¨çŠ¶æ€
SELECT 'è§¦å‘å™¨çŠ¶æ€' as "æ£€æŸ¥é¡¹", trigger_name as "è§¦å‘å™¨åç§°" 
FROM information_schema.triggers 
WHERE trigger_name = 'trigger_auto_assign_admin_role';
```

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

### æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£
```bash
cat ç®¡ç†å‘˜è‡ªåŠ¨åˆ†é…è¯´æ˜.md
```

### å¸¸è§é—®é¢˜
- Q: å¦‚ä½•æ·»åŠ å¤šä¸ªç®¡ç†å‘˜ï¼Ÿ
  - A: ä½¿ç”¨ SQL æ‰‹åŠ¨æå‡ç”¨æˆ·æƒé™

- Q: å¯ä»¥æœ‰å¤šä¸ªè‡ªåŠ¨ç®¡ç†å‘˜é‚®ç®±å—ï¼Ÿ
  - A: ç›®å‰åªæ”¯æŒä¸€ä¸ªï¼Œå…¶ä»–ç®¡ç†å‘˜éœ€è¦æ‰‹åŠ¨æ·»åŠ 

- Q: ä¿®æ”¹ç®¡ç†å‘˜é‚®ç®±åéœ€è¦é‡å¯å—ï¼Ÿ
  - A: ä¸éœ€è¦ï¼Œç«‹å³ç”Ÿæ•ˆ

---

**ç®¡ç†å‘˜é‚®ç®±**: 1062250152@qq.com  
**é…ç½®æ—¶é—´**: 2025-01-10  
**çŠ¶æ€**: âœ… å·²ç”Ÿæ•ˆ
