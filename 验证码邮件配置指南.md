# 🔧 验证码邮件配置指南

## ⚠️ 问题说明

**当前问题**: 邮件中收到的是魔法链接（Magic Link），而不是6位数字验证码。

**原因**: Supabase Auth 默认发送魔法链接，需要修改邮件模板才能发送数字验证码。

---

## 🎯 解决方案（5分钟，3步骤）

### 步骤1: 访问 Supabase Dashboard

直接访问邮件模板设置页面：
```
https://supabase.com/dashboard/project/zrfnnerdaijcmhlemqld/auth/templates
```

### 步骤2: 修改 "Confirm signup" 邮件模板

1. 找到 **"Confirm signup"** 模板
2. 点击进入编辑页面

### 步骤3: 替换为以下模板内容

复制下面的模板内容，粘贴到编辑器中，然后点击 **"Save"** 保存：

```html
<h2>确认您的邮箱</h2>

<p>您好！</p>

<p>感谢您使用人格特质投资策略评估系统。</p>

<p>您的验证码是：</p>

<h1 style="font-size: 32px; font-weight: bold; color: #1DB954; letter-spacing: 5px; margin: 20px 0;">{{ .Token }}</h1>

<p>此验证码将在 <strong>5分钟</strong> 后过期。</p>

<p>如果您没有请求此验证码，请忽略此邮件。</p>

<hr style="margin: 30px 0; border: none; border-top: 1px solid #e0e0e0;">

<p style="color: #666; font-size: 12px;">
  这是一封自动发送的邮件，请勿回复。<br>
  人格特质投资策略评估系统
</p>
```

---

## ⚠️ 重要提示

### 关键变量
- `{{ .Token }}` - 这是6位数字验证码的占位符
- ⚠️ **不要删除或修改这个变量！**

### 保存后
1. 点击 **"Save"** 按钮保存模板
2. 等待1-2分钟让配置生效
3. 重新测试发送验证码
4. 检查邮箱，应该收到数字验证码

---

## ✅ 预期结果

配置完成后，您将收到这样的邮件：

```
确认您的邮箱

您好！

感谢您使用人格特质投资策略评估系统。

您的验证码是：

123456

此验证码将在 5分钟 后过期。

如果您没有请求此验证码，请忽略此邮件。
```

---

## 🔄 测试步骤

1. **保存邮件模板**
   - 在 Supabase Dashboard 中点击 "Save"

2. **等待配置生效**
   - 等待1-2分钟

3. **返回应用登录页面**
   - 访问应用的登录页面

4. **发送验证码**
   - 输入邮箱：`1062250152@qq.com`
   - 点击"发送验证码"

5. **检查邮箱**
   - 查看收件箱（或垃圾邮件箱）

6. **确认收到数字验证码**
   - 邮件中应该显示6位数字

7. **输入验证码登录**
   - 在登录页面输入验证码
   - 点击"验证登录"

8. **✅ 登录成功！**
   - 自动跳转到管理后台

---

## 🐛 常见问题

### Q: 修改模板后还是收到魔法链接？

**解决方案**:
1. 确认已点击 "Save" 保存模板
2. 清除浏览器缓存
3. 等待1-2分钟让配置生效
4. 重新发送验证码测试

### Q: 邮件中没有显示验证码？

**解决方案**:
1. 确认模板中包含 `{{ .Token }}` 变量
2. 检查模板语法是否正确
3. 重新保存模板

### Q: 验证码不是6位数字？

**解决方案**:
1. 确认使用的是 "Confirm signup" 模板
2. 查看 Supabase Dashboard → Auth Logs
3. 确认 Email OTP 已启用

---

## 🔗 快速链接

### Supabase Dashboard

**邮件模板设置**:
```
https://supabase.com/dashboard/project/zrfnnerdaijcmhlemqld/auth/templates
```

**认证日志**:
```
https://supabase.com/dashboard/project/zrfnnerdaijcmhlemqld/logs/auth-logs
```

**项目主页**:
```
https://supabase.com/dashboard/project/zrfnnerdaijcmhlemqld
```

---

## ✅ 配置检查清单

- [ ] 访问 Supabase Dashboard
- [ ] 进入 Email Templates 设置
- [ ] 找到 "Confirm signup" 模板
- [ ] 复制上面的邮件模板内容
- [ ] 粘贴到编辑器中
- [ ] 点击 "Save" 保存
- [ ] 等待1-2分钟
- [ ] 测试发送验证码
- [ ] 检查邮箱
- [ ] 确认收到6位数字验证码
- [ ] 使用验证码登录
- [ ] ✅ 登录成功！

---

## 🎊 完成后

配置完成后，您将能够：

- ✅ 收到包含6位数字验证码的邮件
- ✅ 使用验证码完成登录
- ✅ 享受流畅的登录体验
- ✅ 开始使用系统的所有功能

---

## 📚 相关文档

- **配置数字验证码-Supabase设置.md** - 完整配置指南（包含更多模板选项）
- **访问应用说明.md** - 应用访问指南
- **Supabase配置完成.md** - Supabase 配置说明

---

**配置时间**: 约5分钟  
**难度**: ⭐⭐☆☆☆（简单）  
**重要性**: ⭐⭐⭐⭐⭐（必须）

**立即配置，开始使用！** 🚀
